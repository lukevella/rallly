angular.module("rallly",["ui.router","ngResource","btford.modal","ngTagsInput","ngAnimate","ngSanitize"]).config(["$stateProvider","$urlRouterProvider","$locationProvider",function(e,t,n){n.html5Mode(!0),t.otherwise(function(e){var t=e.get("$state");t.go("notfound")}),e.state("newevent",{url:"/new",templateUrl:"templates/newevent.html",controller:"NewEventCtrl"}).state("deletedevent",{templateUrl:"templates/deletedevent.html"}).state("newevent.success",{templateUrl:"templates/newEvent/success.html"}).state("about",{url:"/about",templateUrl:"templates/about.html",controller:"AboutCtrl"}).state("example",{url:"/example",controller:"ExampleCtrl"}).state("notfound",{templateUrl:"templates/notfound.html"}).state("event",{url:"/:id",templateUrl:"templates/event.html",controller:"EventCtrl"}).state("editevent",{url:"/:id/edit",templateUrl:"templates/editevent.html",controller:"EditEventCtrl"}).state("verifyevent",{url:"/verify/:id/code/:code",controller:"VerificationCtrl"}).state("deleteevent",{url:"/delete/:id/code/:code",controller:"DeletionCtrl"})}]).factory("Event",["$resource",function(e){return e("/api/event/:id",{id:"@_id"},{update:{method:"PUT"},verify:{method:"GET",url:"/api/event/:id/code/:code"},destroy:{method:"DELETE",url:"/api/event/:id/code/:code"}})}]).factory("Participant",["$resource",function(e){return e("/api/event/:id/participant/:pid",{id:"@_id"},{update:{method:"PUT"}})}]).factory("Comment",["$resource",function(e){return e("/api/event/:id/comment/:cid",{id:"@_id"},{update:{method:"PUT"}})}]).factory("Title",function(){return{set:function(e){document.title=e}}}),angular.module("rallly").run(["$templateCache",function(e){e.put("templates/about.html",'<div class="box">\n    <div class="box-title">Frequently Asked Questions</div>\n    <div class="box-description">\n        Want to find out more about Rallly? Check out the FAQs below.\n    </div>    <h2>What is Rallly?</h2>\n    <p>\n        Rallly is a collaborative scheduling service that makes deciding on a date fast and easy. In other words, Rallly helps you and your friends decide on a date to host an event.\n    </p>\n    <h2>Why is it called Rallly?</h2>\n    <p>\n        The name is derived from the proper spelling of the word, &ldquo;rally&rdquo;. The Webster dictionary defines rally as, &ldquo;to muster for a common purpose&rdquo; which accurately describes the goal of this service. The inproper spelling can be attributed to the difficulty of finding short and meaningful domain names.\n    </p>\n    <h2>Who made this?</h2>\n    <p>\n        Rallly was created by <a href="http://lukevella.com">Luke Vella</a>.\n    </p>\n</div>\n'),e.put("templates/confirmmodal.html",'<div class="rl-modal-overlay">\n\n<div class="rl-modal-position">\n\n    <div class="rl-modal">\n        <div class="rl-modal-title">{{modal.title}}</div>\n        <div class="rl-modal-message">\n            {{modal.message}}\n        </div>\n        <div class="rl-modal-actions">\n            <button type="button" ng-click="modal.confirm()" ng-show="modal.confirm" class="btn" ng-class="{danger : modal.isDestructive}">{{modal.confirmText}}</button>\n            <button type="button" ng-click="modal.cancel()"  class="btn">{{modal.cancelText}}</button>\n        </div>\n    </div>\n\n</div>\n\n</div>\n'),e.put("templates/deletedevent.html",'<div class="box">\n    <div class="box-message">\n        <div class="main-image">\n            <img src="/images/bin.png" width="100" />\n        </div>\n        <div class="title">Event Deleted</div>\n        <div class="content">\n            This event has been deleted and is no longer accessible.\n        </div>\n    </div>\n</div>\n'),e.put("templates/editevent.html",'<div ng-show="event._id">\n    <div class="box">\n\n        <div class="box-title">Edit Event</div>\n        <div class="box-description">\n            You can makes changes to your existing event by changing the fields in the form below.\n        </div>\n\n        <form novalidate name="form" ng-submit="submit()">\n\n            <section class="box-section" user-form form="form" event="event"></section>\n            <section class="box-section" event-form form="form" event="event"></section>\n            <section class="box-section" date-form form="form" event="event"></section>\n            <section class="box-section" time-form form="form" event="event" ng-show="event.dates.length"></section>\n            <section class="box-section" settings-form form="form" event="event"></section>\n\n            <div class="box-controls box-bottom-sticky">\n                <button type="submit" ng-show="didChange()" class="btn btn-primary" ng-class="{disabled : !didChange()}">\n                    Save Changes\n                </button>\n                <button type="button" ng-click="undoChanges()" class="btn" ng-show="didChange()">Undo Changes</button>\n                <a href="/{{event._id}}" class="btn" ng-hide="didChange()">Done</a>\n            </div>\n\n        </form>\n\n    </div>\n\n</div>\n'),e.put("templates/event.html",'<div ng-show="event._id">\n    <div class="box ">\n        <div class="event-header">\n            <div class="details">\n                <div class="title">\n                    {{event.title}}\n                    <span class="title-label danger" ng-show="event.isClosed">Poll Closed</span>\n                    <span class="title-label success" ng-hide="event.isClosed">Poll Open</span>\n                </div>\n                <div class="subtitle">\n                    Created by <a href="mailto:{{event.creator.email}}">{{event.creator.name}}</a>\n                    &bull; {{event.created | elapsed}}\n                    &bull; <a href="#" ng-click="editEvent()">Edit Details</a>\n                </div>\n            </div>\n            <div class="actions">\n                <button class="btn" ng-click="editEvent()">Edit Event</button>\n            </div>\n        </div>\n        <div class="event-description" ng-if="event.description" ng-bind-html="event.description | linky"></div>\n        <div class="event-location" ng-if="event.location">\n            Location:\n            <a href="http://maps.google.com?q={{event.location}}" target="_blank">{{event.location}}</a>\n        </div>\n\n        <div class="poll-wrapper">\n            <div poll event="event" class="poll"></div>\n        </div>\n    </div>\n\n    <div class="box" ng-hide="event.comments.length == 0 && event.isClosed">\n        <div class="box-title">\n            Discussion\n        </div>\n        <div class="box-description">\n            You can discuss the event with your friends by leaving a comment below.\n        </div>\n        <div discussion event="event">\n\n        </div>\n    </div>\n</div>\n'),e.put("templates/home.html",'<div class="page-placeholder">\n    <div class="image">\n        <img src="/images/mark_large.png" width="67" />\n    </div>\n    <div class="title">\n        Schedule an Event\n    </div>\n    <div class="content">\n        Want to host an event but canâ€™t decide on a date? Click on the button below to start!\n    </div>\n    <button ng-click="newEvent()" class="btn">Schedule New Event</button>\n</div>\n'),e.put("templates/newevent.html",'<div class="box">\n    <div class="box-title">Schedule a New Event</div>\n    <div class="box-description">\n        Fill in the form below to create your event and share it with your friends and colleagues.\n    </div>\n    <form novalidate autocomplete="off" name="form" ng-hide="eventUrl" ng-submit="submit()">\n        <section class="box-section" user-form form="form" event="event"></section>\n\n        <section class="box-section" event-form form="form" event="event"></section>\n\n        <section class="box-section" date-form form="form" event="event"></section>\n\n        <section class="box-section" time-form form="form" event="event" ng-show="event.dates.length"></section>\n\n        <section class="box-section" participants-form form="form" event="event"></section>\n\n        <section class="box-section" settings-form form="form" event="event"></section>\n\n        <div class="box-controls box-bottom-sticky">\n            <button type="submit" class="btn">Create Event</button>\n        </div>\n\n    </form>\n    <div class="box-message animated zoomIn" ng-show="eventUrl">\n        <div class="main-image">\n            <img src="/images/success_large.png" width="100" />\n        </div>\n        <div class="title">Event Created</div>\n        <div class="content">\n            Your event has been created successfully! An email has been sent to each participant with a link to the event page. \n        </div>\n        <div class="mini-divider">\n        </div>\n        <div class="form-group">\n            <input type="text" class="form-control" disabled="true" value="{{eventUrl}}" />\n            <a href="{{eventUrl}}" class="btn form-btn">GO</a>\n        </div>\n    </div>\n</div>\n'),e.put("templates/notfound.html",'<div class="not-found">\n    <video id="gfyVid1" class="gfyVid" width="480" height="360" autoplay="" loop="" muted="muted" style="display: block;" poster="//thumbs.gfycat.com/PaltryComfortableBaldeagle-poster.jpg">\n            <source id="webmsource" src="//zippy.gfycat.com/PaltryComfortableBaldeagle.webm" type="video/webm">\n            <source id="mp4source" src="//zippy.gfycat.com/PaltryComfortableBaldeagle.mp4" type="video/mp4">\n            Sorry, you don\'t have HTML5 video and we didn\'t catch this properly in javascript.\n            You can try to view the gif directly: <a href="http://zippy.gfycat.com/PaltryComfortableBaldeagle.gif">http://zippy.gfycat.com/PaltryComfortableBaldeagle.gif</a>.\n        </video>\n    <div class="overlay">\n        <div class="wrapper">\n            <div class="title">Error 404 </div>\n            <div class="description">The page you are looking for could not be found!</h2>\n            <div class="actions">\n                <a href="/" target="_self">Go to Homepage</a>\n            </div>\n        </div>\n    </div>\n</div>\n'),e.put("templates/notification.html",'<div class="notification {{notification.type}}" ng-click="notification.close()">\n    <div class="title">\n        {{notification.title}}\n    </div>\n    <div class="message">\n        {{notification.message}}\n    </div>\n</div>\n'),e.put("templates/directives/datePicker.html",'<div class="date-picker">\n    <div class="wrapper">\n        <div class="date-picker-head">\n            <a href="#" class="arrow" ng-click="prevMonth()">&#10094;</a>\n            <span class="title">\n                <span class="title-text">{{title}}</span>\n            </span>\n            <a href="#" class="arrow" ng-click="nextMonth()">&#10095;</a>\n        </div>\n        <div class="dow">\n            <div class="day">\n                Su\n            </div>\n            <div class="day">\n                Mo\n            </div>\n            <div class="day">\n                Tu\n            </div>\n            <div class="day">\n                We\n            </div>\n            <div class="day">\n                Th\n            </div>\n            <div class="day">\n                Fr\n            </div>\n            <div class="day">\n                Sa\n            </div>\n        </div>\n        <div class="values">\n            <div ng-repeat="day in days" class="value"  ng-class="{ outside : day.isOutsideMonth, today : day.isToday, active : isActive(day.date) }" ng-click="selectDay(day)">\n                {{day.date | date : \'d\' }}\n            </div>\n        </div>\n    </div>\n</div>\n'),e.put("templates/directives/discussion.html",'<ul class="comment-thread" ng-show="event.comments.length">\n    <li ng-repeat="comment in event.comments" class="comment">\n        <div class="avatar-section">\n            <img src="/images/avatar.png" />\n        </div>\n        <div class="comment-section">\n            <a href="#" class="comment-delete" ng-click="discussionCtrl.deleteComment(comment)">&times;</a>\n            <div class="meta">\n                <span class="name">{{comment.author.name}}</span>\n                <span class="time">{{comment.created | elapsed}}</span>\n            </div>\n            <div class="content" ng-bind-html="comment.content | linky"></div>\n        </div>\n    </li>\n</ul>\n<form novalidate ng-submit="discussionCtrl.postComment()" name="commentForm" class="comment-form">\n    <div class="avatar-section">\n        <img src="/images/avatar.png" />\n    </div>\n    <div class="input-section form-group">\n        <div class="content-section">\n            <textarea class="form-control" required ng-model="comment.content" placeholder="Write a comment..."></textarea>\n        </div>\n        <div class="name-section">\n            <div class="name-container">\n                <input type="text" class="form-control" required placeholder="Your Name" ng-model="comment.author.name" />\n                <button type="submit" class="btn">Post Comment</button>\n                <span class="form-error" ng-show="commentForm.$submitted && commentForm.$error">\n                    <img src="/images/error.png" width="14" /> Make sure you fill in all the fields.\n                </span>\n            </div>\n        </div>\n    </div>\n</form>\n'),e.put("templates/directives/poll.html",'<div class="poll-header">\n    <div class="header participants-header">\n        {{event.participants.length}} participants\n        <div class="time-label">\n            <div>Start:</div>\n            <div>End:</div>\n        </div>\n    </div>\n\n    <div class="header date-header">\n        <div class="date-cell" ng-repeat="d in event.dates">\n            <div class="date-container">\n                <div class="daticon-container">\n                    <div class="dow">\n                        {{d.raw_date | date: \'EEE\'}}\n                    </div>\n                    <div class="date">\n                        {{d.raw_date | date: \'MMM d\'}}\n                    </div>\n                </div>\n                <div class="times-row">\n                    <div class="time-cell" ng-repeat="time in d.possible_times">\n                        {{time.start_time | date: \'hh:mma\'}}\n                        {{time.end_time | date: \'hh:mma\'}}\n                        <span class="count" ng-show="event.participants.length && numberVotes(time)"\n                              ng-class={top:isTopDate(time)}>{{numberVotes(time)}}</span>\n                        <span class="count" ng-show="!event.participants.length && numberVotesExample($index+$parent.$index)"\n                              ng-class={top:isTopDateExample($index+$parent.$index)}>{{numberVotesExample($index+$parent.$index)}}</span>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div class="header actions-header">\n    </div>\n</div>\n<div class="poll-body">\n    <div class="poll-entry" ng-repeat="participant in event.participants">\n        <form novalidate>\n            <div class="cell name-cell">\n                <span class="avatar style-{{($index % 10) + 1 }}">\n                    <img src="/images/user.png" width="11"/>\n                </span>\n                <input required autocomplete="off" type="text" class="form-control" ng-model="participant.name"\n                       ng-show="editMode" value="participant.name"/>\n                <span ng-hide="editMode" class="name editable"\n                      ng-click="editMode = true && !event.isClosed; pollCtrl.edit(participant)">{{participant.name}}</span>\n            </div>\n            <div class="time-group" ng-repeat="date in event.dates track by date._id">\n                <div class="cell vote-cell" ng-repeat="time in date.possible_times">\n                    <img src="/images/tick@2x.png" width="16" ng-hide="editMode"\n                         ng-if="pollCtrl.hasVote(time, participant)"/>\n                    <img src="/images/nope@2x.png" width="8" ng-hide="editMode"\n                         ng-if="!pollCtrl.hasVote(time, participant)"/>\n                    <input ng-checked="pollCtrl.hasVote(time, participant)" ng-show="editMode" type="checkbox"/>\n\n                    <div class="overlay" ng-show="editMode" ng-click="pollCtrl.toggleVote(time, participant)"></div>\n                </div>\n            </div>\n            <div class="cell action-cell" ng-hide="event.isClosed">\n                <button type="button" ng-hide="editMode" ng-click="editMode = true; pollCtrl.edit(participant)"\n                        class="btn hover">Edit\n                </button>\n                <button type="button" ng-hide="editMode" ng-click="pollCtrl.delete(participant)"\n                        class="btn danger hover">Delete\n                </button>\n                <button type="submit" ng-show="editMode" ng-click="editMode = false; pollCtrl.update()" class="btn">\n                    Save\n                </button>\n                <button type="button" ng-show="editMode" ng-click="editMode = false; pollCtrl.cancel(participant)"\n                        class="btn">Cancel\n                </button>\n            </div>\n        </form>\n    </div>\n    <div class="poll-example" ng-class="{hidden : event.participants.length > 0}">\n        <div class="poll-entry" ng-repeat="example in examples">\n            <div class="cell name-cell">\n                <span class="avatar style-{{$index + 1}}">\n                    <img src="/images/user.png" width="11"/>\n                </span>\n                <span class="name">{{example.name}}</span>\n            </div>\n            <div class="time-group" ng-repeat="date in event.dates">\n                <div class="cell vote-cell" ng-repeat="time in date.possible_times">\n                    <img src="/images/tick@2x.png" width="16" ng-if="example.votes[$index + $parent.$index]"/>\n                    <img src="/images/nope@2x.png" width="8" ng-if="!example.votes[$index + $parent.$index]"/>\n                </div>\n            </div>\n        </div>\n        <div class="overlay">\n            <div class="overlay-text">\n                Fill in the form below to get started\n            </div>\n        </div>\n    </div>\n    <div ng-hide="event.isClosed" class="poll-entry highlight">\n        <form novalidate name="formnew" ng-submit="pollCtrl.save()">\n            <div class="cell name-cell">\n                <span class="avatar style-{{participant.style}}">\n                    <img src="/images/user.png" width="11"/>\n                </span>\n                <input autocomplete="off" name="username" type="text" class="form-control" placeholder="Your name..."\n                       ng-model="participant.name" required value="participant.name"/>\n            </div>\n            <div class="time-group" ng-repeat="date in event.dates track by date._id">\n                <div class="cell vote-cell" ng-repeat="time in date.possible_times">\n                    <input ng-model="participantVotes[date._id][time._id]" ng-false-value="false" type="checkbox"/>\n\n                    <div class="overlay"\n                         ng-click="participantVotes[date._id][time._id] = !participantVotes[date._id][time._id]"></div>\n                </div>\n            </div>\n            <div class="cell action-cell">\n                <button type="submit" ng-class="{ \'animated shake\' : formnew.$submitted && formnew.$invalid  }"\n                        class="btn">Save\n                </button>\n            </div>\n        </form>\n    </div>\n</div>\n'),e.put("templates/directives/timePicker.html",'<div class="time-picker">\n    <div class="time-picker-col">\n        <div class="daticon">\n            <div class="dow">\n                {{date | date: \'EEE\'}}\n            </div>\n            <div class="day">\n                {{date | date: \'d\'}}\n            </div>\n            <div class="month">\n                {{date | date : \'MMM\'}}\n            </div>\n            <!-- <span class="delete" ng-click="datepicker.unsetDate(date)"></span> -->\n        </div>\n    </div>\n    <div class="time-picker-col" ng-repeat="time in date.times track by $index">\n        <input type="text" class="time-picker-input" time-picker ng-model="time" ng-model-options="{ updateOn: \'blur\' }" />\n    </div>\n</div>\n'),e.put("templates/form/dateForm.html",'<div class="section-details">\n    <div class="section-title">Choose Dates</div>\n    <ul class="daticon-list">\n        <li ng-repeat="d in event.dates">\n            <div class="daticon">\n                <div class="dow">\n                    {{d.raw_date | date: \'EEE\'}}\n                </div>\n                <div class="day">\n                    {{d.raw_date | date: \'d\'}}\n                </div>\n                <div class="month">\n                    {{d.raw_date | date : \'MMM\'}}\n                </div>\n                <span class="delete" ng-click="datepicker.removeDate(d)"></span>\n            </div>\n        </li>\n    </ul>\n</div>\n<div class="section-main">\n    <div class="form-row">\n        <div class="form-group">\n            <label for="email">Calendar</label>\n            <span class="form-error" ng-show="form.$submitted && form.datepicker.$error.required">\n                <img src="/images/error.png" width="14" /> You need to select a few dates\n            </span>\n            <div datepicker required name="datepicker" control="datepicker" ng-model="event.dates"></div>\n        </div>\n    </div>\n</div>\n'),e.put("templates/form/eventForm.html",'<div class="section-details">\n    <div class="section-title">Event Details</div>\n</div>\n<div class="section-main">\n    <div class="form-row">\n        <div class="form-col">\n            <div class="form-group">\n                <label for="title">Title</label>\n                <span class="form-error" ng-show="(form.title.$touched || form.$submitted) && errors.title">\n                    <img src="/images/error.png" width="14" /> {{errors.title}}\n                </span>\n                <input id="title" name="title" ng-maxlength="30" required ng-model="event.title" type="text" placeholder="Monthly Meetup..." class="form-control extend"/>\n            </div>\n        </div>\n        <div class="form-col">\n            <div class="form-group optional">\n                <label for="location">Location</label>\n                <span class="form-error" ng-show="(form.location.$touched || form.$submitted) && errors.location">\n                    <img src="/images/error.png" width="14" /> {{errors.location}}\n                </span>\n                <input id="location" name="location" ng-model="event.location" ng-maxlength="50" type="text" placeholder="Rick\'s Cafe..." class="form-control extend"/>\n            </div>\n        </div>\n    </div>\n    <div class="form-row">\n        <div class="form-group optional">\n            <label for="description" >Description</label>\n            <textarea id="description" name="description" ng-model="event.description" placeholder="Enter Description..." class="form-control extend"></textarea>\n        </div>\n    </div>\n</div>\n'),e.put("templates/form/participantsForm.html",'<div class="section-details">\n    <div class="section-title">Invite Participants</div>\n</div>\n<div class="section-main">\n    <div class="form-row">\n        <div class="form-group optional">\n            <label>Participant\'s Emails</label>\n            <tags-input max-length="50" allowed-tags-pattern="{{emailRegex}}" display-property="email" ng-model="event.emails" placeholder="Add an Email" type="email" autocomplete="off"></tags-input>\n            <input type="hidden" name="shouldCreate" value="true" />\n\n        </div>\n    </div>\n</div>\n'),e.put("templates/form/settingsForm.html",'<div class="section-details">\n    <div class="section-title">Settings</div>\n</div>\n<div class="section-main">\n    <div class="switch-row" ng-if="event._id">\n        <div class="switch-details">\n            <div class="title">\n                Poll Status\n            </div>\n            <div class="description">\n                Let people vote on the poll.\n            </div>\n        </div>\n        <div class="switch">\n            <div class="switch-value">\n                {{event.isClosed ? \'Closed\' : \'Open\' }}\n            </div>\n            <div switch-toggle ng-model="event.isClosed" invert>\n            </div>\n        </div>\n    </div>\n    <div class="switch-row">\n        <div class="switch-details">\n            <div class="title">\n                Notifications\n            </div>\n            <div class="description">\n                Send me an email when someone votes or comments on the event.\n            </div>\n        </div>\n        <div class="switch">\n            <div class="switch-value">\n                {{event.creator.allowNotifications ? \'Enabled\' : \'Disabled\' }}\n            </div>\n            <div switch-toggle ng-model="event.creator.allowNotifications">\n            </div>\n        </div>\n    </div>\n    <div class="switch-row" ng-if="event._id">\n        <div class="switch-details">\n            <div class="title">\n                Delete Event\n            </div>\n            <div class="description">\n                Once you delete an event it will no longer be accessible.\n            </div>\n        </div>\n        <div class="switch">\n            <button type="button" ng-click="deleteEvent()" class="btn" ng-class="{danger : !deleteRequestSent, disabled : deleteRequestSent}">{{deleteRequestSent ? \'Request Sent\' : \'Delete Event\' }}</button>\n        </div>\n    </div>\n</div>\n</section>\n'),e.put("templates/form/timeForm.html",'<div class="section-details">\n    <div class="section-title">Choose Times</div>\n</div>\n<div class="section-main">\n    <table class="time-form">\n        <thead>\n        <tr>\n            <th>\n                Date\n            </th>\n            <th>\n                Start Time\n            </th>\n            <th>\n                End Time\n            </th>\n            <th>\n            </th>\n        </tr>\n        </thead>\n        <tbody>\n        <tr ng-repeat-start="d in event.dates">\n            <td class="date-label-cell" rowspan="2">\n                <div class="daticon block">\n                    <div class="dow">\n                        {{d.raw_date | date: \'EEE\'}}\n                    </div>\n                    <div class="day">\n                        {{d.raw_date | date: \'d\'}}\n                    </div>\n                    <div class="month">\n                        {{d.raw_date | date: \'MMM\'}}\n                    </div>\n                    <span class="delete" ng-click="unsetDate(d)"></span>\n                </div>\n            </td>\n            <td class="start-column">\n                <input ng-repeat="time in d.possible_times" type="time" ng-model-options="{updateOn: \'blur\'}"\n                       ng-model="d.possible_times[$index].start_time" class="time-picker-input"/>\n            </td>\n            <td class="end-column">\n                <input ng-repeat="time in d.possible_times" type="time" ng-model-options="{updateOn: \'blur\'}"\n                       ng-model="d.possible_times[$index].end_time" class="time-picker-input"/>\n            </td>\n            <td style="min-width: 111px; vertical-align: bottom;">\n                <button class="center remove-time" ng-repeat="time in d.possible_times"\n                        ng-click="removeTime(time, d, $index); $event.preventDefault();" ng-if="$index !== 0">\n                    Remove\n                </button>\n            </td>\n        </tr>\n        <tr ng-repeat-end>\n            <td colspan="2">\n                <button class="center add-time" ng-click="addTime(d); $event.preventDefault();">Add</button>\n            </td>\n            <td></td>\n        </tr>\n        </tbody>\n    </table>\n</div>\n'),e.put("templates/form/userForm.html",'<div class="section-details">\n    <div class="section-title">Your Details</div>\n</div>\n<div class="section-main">\n    <div class="form-row">\n        <div class="form-col">\n            <div class="form-group">\n                <label for="name">Name</label>\n                <span class="form-error" ng-show="(form.name.$touched || form.$submitted) && errors.name">\n                    <img src="/images/error.png" width="14" /> {{errors.name}}\n                </span>\n                <input id="name" name="name" ng-maxlength="30" required ng-model="event.creator.name" type="text" placeholder="John Doe..." class="form-control extend"/>\n            </div>\n        </div>\n        <div class="form-col">\n            <div class="form-group">\n                <label for="email">Email</label>\n                <span class="form-error" ng-show="(form.email.$touched || form.$submitted) && errors.email">\n                    <img src="/images/error.png" width="14" /> {{errors.email}}\n                </span>\n                <input type="email" id="email" name="email" ng-pattern="emailRegex" required ng-model="event.creator.email" placeholder="john.doe@email.com..." class="form-control extend"/>\n            </div>\n        </div>\n    </div>\n</div>\n')}]),angular.module("rallly").controller("AboutCtrl",["Title",function(e){e.set("About Rallly")}]),angular.module("rallly").controller("AccountCtrl",["$scope","ConfirmModal",function(e){e.showNotice=function(){}}]),angular.module("rallly").controller("EditEventCtrl",["$scope","$http","$state","$timeout","Event","ConfirmModal","Notification","Title",function(e,t,n,i,a,o,s,l){var r=n.params.id;a.get({id:r},function(t){_.forEach(t.dates,function(e){e.raw_date=new Date(e.raw_date),_.forEach(e.possible_times,function(e){e.start_time=new Date(e.start_time),e.end_time=new Date(e.end_time)})}),e.event=t,l.set("Edit: "+e.event.title),e.master=angular.copy(e.event)},function(){n.go("notfound")}),e.$watch("event.isDeleted",function(e){e&&n.go("deletedevent")}),e.undoChanges=function(){e.event=angular.copy(e.master)},e.didChange=function(){return JSON.stringify(e.master)!=JSON.stringify(e.event)},e.didChangeDates=function(){return JSON.stringify(e.master.dates)!=JSON.stringify(e.event.dates)},e.submit=function(){if(e.form.$valid)if(e.didChangeDates()){new o({title:"Hold up!",message:"Changing the dates will reset all entries by the participants. Are you sure you want to do that?",confirmText:"Yes, I'm sure",isDestructive:!0,confirm:function(){e.event.participants=[],d()}})}else d();else{new s({title:"Not so fast",message:"Make sure you fill in all the required fields and try again.",type:"error"})}};var d=function(){a.update({id:r},e.event,function(){new s({title:"Changes Saved",message:"Your changes have been saved successfully.",type:"success"});e.master=angular.copy(e.event)})}}]),angular.module("rallly").controller("EventCtrl",["$scope","$http","$state","Title","Event","ConfirmModal","Communicator",function(e,t,n,i,a,o,s){var l=n.params.id;e.event=a.get({id:l},function(t){return t.isDeleted?void n.go("deletedevent"):(s.trigger("view:event",t),i.set(e.event.title),void(e.eventUrl=n.href("event",{id:e.event._id},{absolute:!0})))},function(){n.go("notfound")}),e.openEvent=function(){e.event.isClosed=!1,a.update({id:l},e.event,function(){new o({title:"Event Open",message:"People can vote and comment on this event.",cancelText:"OK"})})},e.closeEvent=function(){e.event.isClosed=!0,a.update({id:l},e.event,function(){new o({title:"Event Closed",message:"People can no longer vote or comment on this event.",cancelText:"OK"})})},e.editEvent=function(){n.go("editevent",{id:e.event._id})}}]),angular.module("rallly").controller("ExampleCtrl",["$state","Event",function(e,t){var n=["John Example","Jane Specimen","Mark Instance","Mary Case"],i=[];_.forEach(n,function(e){i.push({name:e})});var a=[],o=4,s=new Date;
s.setSeconds(0),s.setMilliseconds(0);for(var l=0;o>l;++l){for(var r={raw_date:s.add(Math.ceil(5*Math.random())).days().toISOString(),possible_times:[]},d=0;d<Math.ceil(3*Math.random());++d){var c=s.add(Math.ceil(5e3*Math.random())).minutes().toISOString(),m=new Date(c).add(Math.ceil(5e3*Math.random())).minutes().toISOString();r.possible_times.push({start_time:c,end_time:m})}a.push(r)}var v=new t({creator:{name:"John Example",email:"rallly@lukevella.com",allowNotifications:!1},title:"Lunch Meeting",location:"Starbucks, 901 New York Avenue",description:"This event has been automatically generated just for you! Feel free to try out all the different features and when you're ready, you can schedule a new event.",dates:a,participants:i,emails:[],comments:[{author:{name:"John Example"},content:"Hey guys, this is a comment!"},{author:{name:"Mark Instance"},content:"Hi John... nice comment. Keep up the great work!"},{author:{name:"John Example"},content:"Thank you!"}],isExample:!0});v.$save(function(n){_.forEach(n.dates,function(e){_.forEach(e.possible_times,function(e){e.voted_by=_.sample(_.pluck(n.participants,"_id"),_.random(n.participants.length))})}),t.update({id:n._id},n,function(t){e.go("event",{id:t._id},{location:"replace"})})})}]),angular.module("rallly").controller("HomeCtrl",["$scope","$state","Title",function(e,t,n){n.set("Rallly - Collaborative Scheduling"),e.newEvent=function(){t.go("newevent")}}]),angular.module("rallly").controller("NavigationCtrl",["$scope","$rootScope","$location","$document",function(e,t,n,i){e.isActive=function(e){return n.path()==e?!0:!1};var a=function(t){var n=angular.element(".mobile-navigation").find(t.target).length>0;console.log(n),n||e.toggleMenu()};t.$on("$stateChangeSuccess",function(){angular.element("body").removeClass("open-menu"),i.unbind("click",a)}),e.toggleMenu=function(){console.log("click");var e=angular.element("body").hasClass("open-menu");e?(angular.element("body").removeClass("open-menu"),i.unbind("click",a)):(angular.element("body").addClass("open-menu"),i.bind("click",a))}}]),angular.module("rallly").controller("NewEventCtrl",["$scope","$http","$state","Event","ConfirmModal","Notification","Communicator",function(e,t,n,i,a,o,s){e.title="Schedule a New Event",e.description="Fill in the form below to create your event and share it with your friends and colleagues.",e.event={creator:{allowNotifications:!0}},e.submit=function(){if(e.form.$valid){var t=new i(e.event);t.$save().then(function(t){_.forEach(t.dates,function(e){e.raw_date=new Date(e.raw_date),_.forEach(e.possible_times,function(e){e.start_time=new Date(e.start_time),e.end_time=new Date(e.end_time)})}),e.event=t,e.eventUrl=n.href("event",{id:e.event._id},{absolute:!0}),s.trigger("add:event",t),n.go("newevent.success")},function(){new a({title:"Uh oh!",message:"There was an error creating your event. Please try again later.",cancelText:"OK"})})}else{new o({title:"Hold on!",message:"Make sure you fill in all the required fields and that your data is correct."})}}}]),angular.module("rallly").controller("VerificationCtrl",["Event","Notification","$state",function(e,t,n){e.verify({id:n.params.id,code:n.params.code},function(){new t({title:"Email Verified",message:"Your email has been verified. You will now be able to receive email notifications for this event",type:"success",timeout:5e3})},function(){new t({title:"Verification Failed",message:"Your verification code has expired.",type:"error"})}),n.go("event",{id:n.params.id},{location:"replace"})}]),angular.module("rallly").filter("elapsed",["$filter",function(e){return function(t){if(t){var n=Date.parse(t),i=(new Date).getTime(),a=i-n,o=Math.floor(a/1e3),s=Math.floor(o/60),l=Math.floor(s/60),r=Math.floor(l/24);return r>30?"on "+e("date")(t,"MMMM d"):r>1?r+" days ago":1==r?"1 day ago":l>1?l+" hours ago":1==l?"an hour ago":s>1?s+" minutes ago":1==s?"a minute ago":"a few seconds ago"}}}]),angular.module("rallly").directive("backImg",function(){return function(e,t,n){var i=n.backImg;t.css({"background-image":"url(/images/"+i+".png)"})}}),angular.module("rallly").directive("datepicker",function(){return{restrict:"A",require:"ngModel",scope:{model:"=ngModel",control:"="},templateUrl:"templates/directives/datePicker.html",link:function(e,t,n,i){e.model=e.model||[],e.control=e.control||{},e.$watch("model",function(e){i.$setViewValue(e),i.$validate()},!0),i.$validators.required=function(e){return e&&0!=e.length?!0:!1};var a=Date.today(),o=a.clone(),s=function(t){o=t;var n=o.clone().moveToFirstDayOfMonth(),i=n.getDay();0==i?n.add(-7).days():n.add(-1*i).days(),e.title=o.toString("MMMM yyyy");for(var s=new Array(42),l=0;l<s.length;l++){var r=n.clone().add(l).days();s[l]={date:r,isOutsideMonth:r.getMonth()!=o.getMonth()?!0:!1,isToday:Date.equals(r,a)}}e.days=s};s(o),e.selectDay=function(t){if(t.isOutsideMonth&&s(t.date),-1!=(n=e.isActive(t.date,!0)))e.model.splice(n,1);else{var n=0,i=!1;do{if(void 0==e.model[n]||Date.compare(Date.parse(e.model[n].raw_date),t.date)>0){var a={raw_date:t.date,possible_times:[{start_time:null,end_time:null}]};e.model.splice(n,0,a),i=!0}n++}while(0==i)}},e.isActive=function(t,n){e.model=e.model||[];for(var i=0;i<e.model.length;i++){var a=Date.parse(e.model[i].raw_date);if(a.getDate()==t.getDate()&&a.getMonth()==t.getMonth()&&a.getYear()==t.getYear())return n?i:!0}return n?-1:!1},e.nextMonth=function(){s(o.clone().add(1).months())},e.prevMonth=function(){s(o.clone().add(-1).months())},e.control.removeDate=function(t){-1!=(index=e.isActive(Date.parse(t.raw_date),!0))&&e.model.splice(index,1)}}}}),angular.module("rallly").directive("discussion",["$timeout","Comment","ConfirmModal","Communicator",function(e,t,n,i){return{restrict:"A",templateUrl:"templates/directives/discussion.html",scope:{event:"="},controllerAs:"discussionCtrl",controller:["$scope","$rootScope",function(a,o){a.comment={author:{},comment:""},o.$on("add:participant",function(e,t,n){a.comment.author.name=n.name}),this.deleteComment=function(e){new n({title:"Are you sure?",message:"Are you sure you want to remove this comment?",confirmText:"Yes - delete",cancelText:"No - nevermind",isDestructive:!0,confirm:function(){t.remove({id:a.event._id,cid:e._id},function(e){a.event=e})}})},this.postComment=function(){if(a.commentForm.$valid){var n=new t(a.comment);n.$save({id:a.event._id},function(t){a.event=t,i.trigger("add:comment",t,a.comment),a.comment.content="",e(a.scrollToBottom)}),a.commentForm.$setPristine()}},a.scrollToBottom=function(){var e=angular.element(".comment-thread");e.scrollTop(e.prop("scrollHeight"))}}],link:function(t){e(t.scrollToBottom)}}}]),angular.module("rallly").directive("dropdown",["$document",function(e){return{restrict:"A",link:function(t,n){n.addClass("dropdown"),t.open=!1;var i=function(e){var i=n.find(e.target).length>0;i||t.toggle()};t.toggle=function(){t.open=!t.open,t.open?(n.addClass("open"),e.bind("click",i)):(n.removeClass("open"),e.unbind("click",i))}}}}]),angular.module("rallly").service("FormHelper",function(){this.emailRegexString="^([\\w-\\.]+@([\\w-]+\\.)+[\\w-]{2,4})?$",this.emailRegex=new RegExp(this.emailRegexString),this.prettyError=function(e,t){return e.required?t+" is required":e.pattern?t+" is invalid":e.maxlength?t+" is too long":!1}}).directive("userForm",["FormHelper",function(e){return{scope:{event:"=",form:"="},templateUrl:"templates/form/userForm.html",link:function(t){t.errors={},t.emailRegex=e.emailRegex,t.$watchCollection("form.name.$error",function(n){t.errors.name=e.prettyError(n,"Name")}),t.$watchCollection("form.email.$error",function(n){t.errors.email=e.prettyError(n,"Email")})}}}]).directive("eventForm",["FormHelper",function(e){return{scope:{event:"=",form:"="},templateUrl:"templates/form/eventForm.html",link:function(t){t.errors={},t.$watchCollection("form.title.$error",function(n){t.errors.title=e.prettyError(n,"Title")}),t.$watchCollection("form.location.$error",function(n){t.errors.location=e.prettyError(n,"Location")})}}}]).directive("dateForm",function(){return{scope:{event:"=",form:"="},templateUrl:"templates/form/dateForm.html"}}).directive("timeForm",function(){return{scope:{event:"=",form:"="},templateUrl:"templates/form/timeForm.html",link:function(e){var t=!1,n=e.$watch("event.dates",function(i){i&&!t&&n(),t=!0,e.unsetDate=function(t){var t=new Date(t.raw_date);_.remove(e.event.dates,function(e){var e=new Date(e.raw_date);return e.getTime()===t.getTime()})},e.addTime=function(t){e.event.dates[e.event.dates.indexOf(t)].possible_times.push({})},e.removeTime=function(t,n,i){e.event.dates[e.event.dates.indexOf(n)].possible_times.splice(i,1)}})}}}).directive("timePicker",["$timeout",function(){return{scope:{model:"=ngModel"},require:"ngModel",link:function(e,t,n,i){i.$viewChangeListeners.push(function(){e.model=i.$modelValue}),i.$parsers.push(function(e){return e?Date.parse(e):void 0}),i.$validators.time=function(e){if(i.$isEmpty(e))return!0;var t=Date.parse(e);return t?(i.$setViewValue(t.toString("hh:mm tt")),i.$render(),!0):!1}}}}]).directive("participantsForm",["FormHelper",function(e){return{scope:{event:"=",form:"="},templateUrl:"templates/form/participantsForm.html",link:function(t){t.emailRegex=e.emailRegexString}}}]).directive("settingsForm",["Event","ConfirmModal",function(e,t){return{scope:{event:"=",form:"="},templateUrl:"templates/form/settingsForm.html",link:function(n){n.deleteEvent=function(){new t({title:"Are you sure?",message:"The event will no longer be accessible after it is deleted. Are you sure you want to continue?",isDestructive:!0,confirmText:"Yes - delete",cancelText:"Cancel",confirm:function(){e["delete"]({id:n.event._id},function(){n.event.isDeleted=!0})}})}}}}]).directive("switchToggle",function(){return{scope:{model:"=ngModel"},require:"ngModel",link:function(e,t,n,i){t.addClass("switch-toggle");var a=function(){e.model^"undefined"!=typeof n.invert?t.addClass("active"):t.removeClass("active")};e.$watch("model",a),t.bind("click",function(t){e.model=!e.model,i.$setViewValue(e.model,t)})}}}),angular.module("rallly").directive("poll",["$timeout","Participant","Event","ConfirmModal","Communicator",function(e,t,n,i,a){return{restrict:"A",templateUrl:"templates/directives/poll.html",$scope:{event:"="},controllerAs:"pollCtrl",controller:["$scope","$rootScope",function(e,o){e.defaults={},e.participant={},e.participantVotes={},o.$on("add:comment",function(t,n,i){e.didVote||(e.participant.name=i.author.name)}),this.toggleVote=function(e,t){_.contains(e.voted_by,t._id)?_.remove(e.voted_by,function(e){return e.toString()===t._id.toString()}):e.voted_by.push(t._id)},this.hasVote=function(e,t){return _.contains(e.voted_by,t._id)},this["delete"]=function(n){new i({title:"Delete "+n.name+"?",message:"Are you sure you want to remove "+n.name+" from the poll?",confirmText:"Yes - delete",cancelText:"No - nevermind",isDestructive:!0,confirm:function(){t.remove({id:e.event._id,pid:n._id},function(t){e.event=t,a.trigger("delete:participant",t)})}})},this.update=function(){n.update({id:e.event._id},e.event)},this.edit=function(t){_.forEach(e.event.dates,function(n){_.forEach(n.possible_times,function(i){e.defaults[t._id]=e.defaults[t._id]||{},e.defaults[t._id][n._id]=e.defaults[t._id][n._id]||{},e.defaults[t._id][n._id][i._id]=e.defaults[t._id][n._id][i._id]||{},e.defaults[t._id][n._id][i._id]=_.contains(i.voted_by,t._id.toString())})})},this.cancel=function(t){_.forEach(e.event.dates,function(n){_.forEach(n.possible_times,function(i){e.defaults[t._id][n._id][i._id]!==_.contains(i.voted_by,t._id.toString())&&e.pollCtrl.toggleVote(i,t)})})},this.save=function(){if(e.formnew.$valid){var n=new t(e.participant);n.$save({id:e.event._id},function(t){var n=_.pluck(e.event.participants,"_id"),i=_.pluck(t.participants,"_id"),o=_.difference(i,n)[0];e.event=t,e.didVote=!0,a.trigger("add:participant",t,e.participant),_.forEach(e.event.dates,function(t){_.forEach(t.possible_times,function(n){e.participantVotes[t._id]&&e.participantVotes[t._id][n._id]&&n.voted_by.push(o)})}),e.pollCtrl.update(),e.participant={},e.participantVotes={}}),e.formnew.$setPristine()}}}],link:function(e){e.event.$promise.then(function(t){for(var n=["John Example","Jane Specimen","Mark Instance","Mary Case"],i=[],a=0;a<n.length;a++){var o={name:n[a]};o.votes=[];for(var s=0;s<t.dates.length;s++)for(var l=0;l<t.dates[s].possible_times.length;++l){var r=Math.random()<.5;o.votes[s+l]=r}i.push(o)}e.examples=i}),e.isTopDate=function(t){for(var n=e.event.dates[0].possible_times[0].voted_by.length,i=0;i<e.event.dates.length;++i)for(var a=0;a<e.event.dates[i].possible_times.length;++a)e.event.dates[i].possible_times[a].voted_by.length>n&&(n=e.event.dates[i].possible_times[a].voted_by.length);return t.voted_by.length===n},e.numberVotes=function(e){return e.voted_by.length},e.isTopDateExample=function(t){for(var n=e.numberVotesExample(0),i=0;i<e.event.dates.length;++i)for(var a=0;a<e.event.dates[i].possible_times.length;++a){var o=e.numberVotesExample(i+a);o>n&&(n=o)}return n===e.numberVotesExample(t)},e.numberVotesExample=function(t){return _.filter(e.examples,function(e){return e.votes[t]}).length}}}}]),angular.module("rallly").factory("Communicator",["$rootScope",function(e){return new function(){this.trigger=function(){e.$emit.apply(e,arguments)},e.$on("view:event",function(e,t){mixpanel.track("View Event",{id:t._id,participants:t.participants.length,comments:t.comments.length,isExample:t.isExample,dates:t.dates.length})}),e.$on("add:participant",function(e,t){mixpanel.track("Add Participant",{id:t._id})}),e.$on("add:comment",function(e,t){mixpanel.track("Add Comment",{id:t._id})}),e.$on("add:event",function(e,t){mixpanel.track("Add Event",{id:t._id,participants:t.participants.length,comments:t.comments.length,isExample:t.isExample,dates:t.dates.length})})}}]),angular.module("rallly").factory("ConfirmModal",["btfModal",function(e){return function(t){var n;n=e({templateUrl:"templates/confirmmodal.html",controllerAs:"modal",controller:function(){this.title=t.title,this.message=t.message,this.confirm=t.confirm?function(){t.confirm(),n.deactivate()}:!1,this.cancel=n.deactivate,this.confirmText=t.confirmText||"Confirm",this.cancelText=t.cancelText||"Cancel",this.isDestructive=t.isDestructive}}),n.activate(),this.destroy=function(){n.deactivate()}}}]),angular.module("rallly").factory("Notification",["$timeout","btfModal",function(e,t){return function(n){var i;i=t({templateUrl:"templates/notification.html",controllerAs:"notification",controller:function(){this.title=n.title,this.message=n.message,this.close=i.deactivate,this.type=n.type;var t=n.timeout||5e3;e(i.deactivate,t)}}),i.activate(),this.destroy=function(){i.deactivate()}}}]);
//# sourceMappingURL=app.js.map